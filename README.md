# A Model of Individual BMI Trajectories

by [Laurens Bogaardt](https://orcid.org/0000-0002-7712-6627), [Anoukh van Giessen](https://orcid.org/0000-0003-4521-9500), [H. Susan J. Picavet](https://orcid.org/0000-0002-6895-165X), [Hendriek C. Boshuizen](https://orcid.org/0000-0002-3916-9095).

This paper was published on 26 February 2024 in [Mathematical Medicine and Biology](https://doi.org/10.1093/imammb/dqad009).

## Abstract

A risk factor model of BMI is an important building block of health simulations aimed at estimating government policy effects with regard to overweight and obesity. We created a model which generates representative population level distributions and which also mimics realistic BMI trajectories at an individual level so that policies aimed at individuals can be simulated. The model is constructed by combining several datasets. First, the population level distribution is extracted from a large, cross-sectional dataset. The trend in this distribution is estimated from historical data. In addition, longitudinal data are used to model how individuals move along typical trajectories over time. The model faithfully describes the population level distribution of BMI, stratified by sex, level of education and age. It is able to generate life course trajectories for individuals which seem plausible but it does not capture extreme fluctuations, such as rapid weight loss.

## Repository Content

The content of this repository consists of files needed to generate the `.pdf` manuscript and those needed to run the analyses. In particular, the directory `Figures` contains figures which are generated during the analyses and which are used in the article. The directory `Input-Data` contains the raw data on which the analyses are run. The directory `Output-Data` contains `.csv` files which are created during the analyses. The analysis scripts are themselves in the directory `Scripts` as various *R Markdown* files. The knitted `.html` documents are also in this directory. The file `A-Model-of-Individual-BMI-Trajectories.bib` contains the bibliography for the manuscript, and the file `A-Model-of-Individual-BMI-Trajectories.pdf` is the final article which was submitted for publication to [Mathematical Medicine and Biology](https://doi.org/10.1093/imammb/dqad009), after revisions based on the reviewers' suggestions but before proofing and typesetting. This article is generated by the file `A-Model-of-Individual-BMI-Trajectories.tex` in combination with the LaTeX class `imammb.cls` containing journal-specific functions.

## Getting the Code

You can download a copy of all the files in this [git](https://git-scm.com/) repository by cloning the repository using:

    git clone https://github.com/rivm-syso/A-Model-of-Individual-BMI-Trajectories.git

or by downloading a [zip archive](https://github.com/rivm-syso/A-Model-of-Individual-BMI-Trajectories/archive/refs/heads/master.zip).

## Getting the Data

Our analyses are based on multiple datasets, most of which are not open access and are not included in this repository. Access to the data needs to be requested separately to be able to reproduce the results.

The *Gezondheidsmonitor* is a Dutch cross-sectional dataset based on a large, health-related questionnaire administered by the *Community Health Services*, *Statistics Netherlands* and the *National Institute for Public Health and the Environment*. The dataset contains self-reported weight and height measurements, rounded to nearest kilogram and centimetre. The included survey weights allow for representative analyses of the Netherlands. The *Gezondheidsmonitor* data are not open access. To request access to the data, please visit [www.monitorgezondheid.nl](https://www.monitorgezondheid.nl/).

Historical BMI data were assessed by *Statistics Netherlands* and the *National Institute for Public Health and the Environment*. We use the prevalences of overweight and obesity for adults between 1990 and 2021 which were standardised to the demography of the Netherlands in 2021 by *VZinfo.nl*. These data are open access and can be found on [www.vzinfo.nl/overgewicht](https://www.vzinfo.nl/overgewicht/leeftijd-geslacht/volwassenen). A copy of the relevant dataset is included in this repository.

The *Doetinchem Cohort Study* followed a sex- and age stratified random sample from the population registers of the municipality of Doetinchem in the Netherlands for the past 30 years. Its aim is to study lifestyle factors and biological risk factors on aspects of health. The participants underwent a health examination about every 5 years since 1987. The *Doetinchem* data are not open access. To request access to the data, please visit [www.rivm.nl/doetinchem-cohort-studie](https://www.rivm.nl/doetinchem-cohort-studie).

The *Longitudinal Internet studies for the Social Sciences (LISS)* panel is a representative sample of Dutch individuals who participate in monthly Internet surveys. The panel is based on a true probability sample of households drawn from the population register. Households that could not otherwise participate are provided with a computer and Internet connection. A longitudinal survey is fielded in the panel every year, covering a large variety of domains including health, work, education, income, housing, time use, political views, values and personality. The *LISS* data are not open access. To request access to the data, please visit [www.lissdata.nl](https://www.lissdata.nl/).

## Setting up the Environment

The analyses require `R` to run the code and `LaTeX` to typeset the article, including various packages. To setup the environment, the following software need to be installed:

- [R](https://www.r-project.org/)
- [RStudio](https://posit.co/download/rstudio-desktop/)
- R Packages
  - [gamlss](https://cran.r-project.org/package=gamlss)
  - [gganimate](https://cran.r-project.org/package=gganimate)
  - [ggbreak](https://cran.r-project.org/package=ggbreak)
  - [ggforce](https://cran.r-project.org/package=ggforce)
  - [gifski](https://cran.r-project.org/package=gifski)
  - [haven](https://cran.r-project.org/package=haven)
  - [mnormt](https://cran.r-project.org/package=mnormt)
  - [nlme](https://cran.r-project.org/package=nlme)
  - [splines](https://www.rdocumentation.org/packages/splines)
  - [tidyverse](https://cran.r-project.org/package=tidyverse)
  - [vtable](https://cran.r-project.org/package=vtable)
- TeX distribution (e.g. [MikTex](https://miktex.org/))
- LaTeX Packages
  - [natbib](https://ctan.org/pkg/natbib)
  - [graphicx](https://ctan.org/pkg/graphicx)
  - [amsmath](https://ctan.org/pkg/amsmath)
  - [amsthm](https://ctan.org/pkg/amsthm)
  - [bm](https://ctan.org/pkg/bm)
  - [mathrsfs](https://ctan.org/pkg/mathrsfs)
  - [hyperref](https://ctan.org/pkg/hyperref)
  - [imammb.cls](https://academic.oup.com/imammb/pages/General_Instructions) (included in this repository)

## Reproducing the Results

To reproduce the results, first [get the code](#getting-the-code) and [the data](#getting-the-data). The code assumes that there is a  file named `2022_07_22_GM2012_Totaalbestand GGD en CBS (N=387195).sav` for the 2012 *Gezondheidsmonitor* dataset and one named `2018_06_20_Totaalbestand GGD en CBS (N=457153) Landelijk.sav` for the 2016 *Gezondheidsmonitor* dataset, placed in the directory `Input-Data/Gezondheidsmonitor`. Likewise, it assumes there is a file named `doetcoh_lcdm_update.sas7bdat` for the *Doetinchem Cohort Study* dataset in the directory `Input-Data/Doetinchem`. The *LISS* data is contained in multiple `.sav` files which should all be placed in the directory `Input-Data/LISS`. Once this is complete, [set up the environment](#setting-up-the-environment) by installing the required software and packages. Then, run or knit the *R Markdown* files. The following order is recommended:

- Scripts/Clean-Gezondheidsmonitor.Rmd
- Scripts/Clean-VZinfo.Rmd
- Scripts/Clean-Doetinchem.Rmd
- Scripts/Clean-LISS.Rmd
- Scripts/Generalised-Autoregressive-Model.Rmd (optional)
- Scripts/Population-Level-Distribution-of-BMI.Rmd
- Scripts/Historical-Trend-of-BMI.Rmd
- Scripts/Individual-Trajectories-of-BMI.Rmd

These scripts will output `.csv` files to the directory `Output-Data` and will produce `.pdf` figures in the directory `Figures`. Finally, typeset the file `A-Model-of-Individual-BMI-Trajectories.tex` using *TeXworks* or by running 

    pdflatex A-Model-of-Individual-BMI-Trajectories.tex &
    bibtex A-Model-of-Individual-BMI-Trajectories.aux &
    pdflatex A-Model-of-Individual-BMI-Trajectories.tex &
    pdflatex A-Model-of-Individual-BMI-Trajectories.tex

in the command line. The reproduced article is identical to the one submitted for publication to [Mathematical Medicine and Biology](https://doi.org/10.1093/imammb/dqad009), after revisions based on the reviewers' suggestions but before proofing and typesetting.

## License

All source code is made available under a CC-BY-4.0 license. You can freely use and modify the code, without warranty, so long as you provide attribution to the authors. See `LICENSE` for the full license text.
